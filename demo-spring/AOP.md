

# <span style="color: red"> AOP 面向切面编程 </span>

# AOP 编程理念
面向切面编程，即 AOP，是一种编程思想，它允许程序员对横切关注点或横切典型的职责分界线的 
行为（例如日志和事务管理）进行模块化。AOP 的核心构造是方面（切面），它将那些影响多个类的行
为封装到可重用的模块中。

AOP 和 IOC 是补充性的技术，它们都运用模块化方式解决企业应用程序开发中的复杂问题。在典
型的面向对象开发方式中，可能要将日志记录语句放在所有方法和 Java 类中才能实现日志功能。在 AOP
方式中，可以反过来将日志服务模块化，并以声明的方式将它们应用到需要日志的组件上。当然，优势
就是 Java 类不需要知道日志服务的存在，也不需要考虑相关的代码。所以，用 Spring AOP 编写的应用程序代码是松散耦合的。
AOP 的功能完全集成到了 Spring 事务管理、日志和其他各种特性的上下文中。
AOP 编程的常用场景有：Authentication（权限认证）、Auto Caching（自动缓存处理）、Error Handling
（统一错误处理）、Debugging（调试信息输出）、Logging（日志记录）、Transactions（事务处理）
等。


Spring 总共大约有 20 个模块，由 1300 多个不同的文件构成。而这些组件被分别整合在核心容器（Core
Container）、AOP（Aspect Oriented Programming）和设备支持（Instrmentation）、数据访问
及集成（Data Access/Integeration）、Web、报文发送（Messaging）、Test，6 个模块集合中。以
下是 Spring 5 的模块结构图
![img.png](../demo-spring-security/SpringSecurity.assets/img-aop1.png)

# 核心容器

| module                 | module function                                                                                                                                                                                                             |
|------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| spring-beans           | spring-core 和 spring-beans 模块是 Spring 框架的核心模块，包含了控制反转（Inversion ofControl, IOC）和依赖注入（Dependency Injection, DI）                                                                                                              |
| spring-core            | spring-core 和 spring-beans 模块是 Spring 框架的核心模块，包含了控制反转（Inversion ofControl, IOC）和依赖注入（Dependency Injection, DI）                                                                                                              |
| spring-context         | 扩展了 BeanFactory，为她添加了 Bean 生命周期控制、框架事件体系以及资源加载透明化等功能。此外该模块还提供了许多企业级支持，如邮件访问、远程访问、任务调度等。ApplicationContext 是该模块的核心接口，她的超类是 BeanFactory。与BeanFactory 不同，ApplicationContext 容器实例化后会自动对所有的单实例 Bean 进行实例化与依 赖关系的装配，使之处于待用状态。     |
| spring-expression      | 模块是统一表达式语言（EL）的扩展模块，可以查询、管理运行中的对象，同时也方便的可以调用对象方法、操作数组、集合等。                                                                                                                                                                  |
| spring-context-support | Spring IOC 容器的扩展支持，以及 IOC 子容器                                                                                                                                                                                               |
| spring-context-indexer | Spring 的类管理组件和 Classpath 扫描                                                                                                                                                                                                 |

# AOP和设备支持
| module                 | module function                                                                                                                                                                                                                                                   |
|------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| spring-aop             | AOP 主要的实现模块。作为继 OOP 后，对程序员影响最大的编程思想之一，AOP 极大地开拓了人们对于编程的思路。  他是以 JVM 的动态代理技术为基础，然后设计出了一系列的 AOP 横切实现，比如前置通知、返回通知、异常通知等，同 时，Pointcut 接口来匹配切入点，可以使用现有的切入点来设计横切面，也可以扩展相关方法根据需求 进行切入。                                                                                   |                                                                                                                                                                                                           |
| spring-aspects         | AspectJ 框架，主要是为 Spring AOP 提供多种 AOP 实现方法。                                                                                                                                                                                                                         |
| spring-instrument      | 基于 JAVA SE 中的"java.lang.instrument"进行设计的，应该算是 AOP的一个支援模块，主要作用是在 JVM 启用时，生成一个代理类，程序员通过代理类在运行时修改类的 字节，从而改变一个类的功能，实现 AOP 的功能。                                                                                                                                        |

# 数据访问与集成
| module             | module function                                                                                                                                                                                                                                                               |
|--------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| spring-jdbc        | 用于简化 Spring JDBC 操作 。主要是提供 JDBC 模板方式、关系数据库对象化方式、SimpleJdbc 方式、事务管理来简化 JDBC 编程， 主要实现类是 JdbcTemplate、SimpleJdbcTemplate 以及 NamedParameterJdbcTemplate。                                                                                                                          |
| spring-tx          | Spring JDBC 事务控制实现模块。使用 Spring 框架，它对事务做了很好的封装，通过它的 AOP 配置，可以灵活的配置在任何一层；但是在很多的需求和应用，直接使用 JDBC 事务控 制还是有其优势的。其实，事务是以业务逻辑为基础的；一个完整的业务应该对应业务层里的一个方法； 如果业务操作失败，则整个事务回滚；所以，事务控制是绝对应该放在业务层的；但是，持久层的设计 则应该遵循一个很重要的原则：保证操作的原子性，即持久层里的每个方法都应该是不可以分割的。所 以，在使用 Spring JDBC 事务控制时，应该注意其特殊性。 |
| spring-orm         | ORM 框架支持模块，主要集成 Hibernate, Java Persistence API (JPA) 和Java Data Objects (JDO) 用于资源管理、数据访问对象(DAO)的实现和事务策略。                                                                                                                                                                    |
| spring-oxm         | 提供一个抽象层以支撑 OXM（OXM 是 Object-to-XML-Mapping 的缩写，它是一个 O/M-mapper，将 java 对象映射成 XML 数据，或者将 XML 数据映射成 java 对象），例如： JAXB, Castor, XMLBeans, JiBX 和 XStream 等。                                                                                                                       |
| spring-jms         | 模块（Java Messaging Service）能够发送和接收信息，自 Spring Framework 4.1 以后，他还提供了对 spring-messaging 模块的支撑                                                                                                                                                                                   |

# Web 组件
| module                 | module function                                                                                                                                                                                                                                                 |
|------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| spring-web             |  Spring 提供了最基础 Web 支持，主要建立于核心容器之上，通过 Servlet 或者 Listeners 来初始化 IOC 容器，也包含一些与 Web 相关的支持。                                                                                  |                                                                                                                                                                                                           |
| spring-webmvc         | 是一个的 Web-Servlet 模块，实现了 Spring MVC（model-view-Controller）的 Web 应用。                                                                                                                                                                                                                    |
| spring-websocket      | 与 Web 前端的全双工通讯的协议。                                                                                                                                      |
| spring-webflux      | 新的非堵塞函数式 Reactive Web 框架，可以用来建立异步的，非阻塞，事件驱动的服务，并且扩展性非常好                                                                                                                                      |

# 通信报文
| module               | module function                                                                                                                                                                                                                                                |
|----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| spring-messaging     |  主要职责是为 Spring 框架集成一些基础的报文传送应用。                                                                                  |                                                                                                                                                                                                           |

# 集成测试
| module                 | module function                                                                                                                                                                                                                                                |
|------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| spring-test            |  毕竟在不需要发布（程序）到你的应用服务器或者连接到其他企业设施的情况下能够执行一些集成测试或者其他测试对于任何企业都是非常重要的。                                                                     |                                                                                                                                                                                                           |

# 集成兼容
| module                | module function                                                                                                                                                                                                                                                 |
|-----------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| spring-framework-bom  | Bill of Materials.解决 Spring 的不同模块依赖版本不同问题。                                                                                 |                                                                                                                                                                                                           |


# 依赖说明
![img.png](../demo-spring-security/SpringSecurity.assets/img-aop2.png)
